import{g as h,P as $,a as T}from"./vendor.96122d15.js";document.querySelector("#app");const E=document.querySelector("body"),b=document.querySelector("main"),p=document.querySelector("#calculator > form"),O=document.querySelectorAll(".select-flag"),r=[document.querySelector("#from"),document.querySelector("#to")],k=document.querySelector("#selected-currency"),g=document.querySelector("#amount"),a=document.querySelector("#date"),D=document.querySelector("#rate"),I=document.querySelector("#swap"),l=document.querySelector("#header-overlay"),u=document.querySelector("#toggle-overlay"),P=document.querySelector("#header"),x=document.querySelector("#result"),U=document.querySelector("#result-rate"),C=document.querySelector('[name="token"]'),i=document.querySelector("#errors-wrapper"),f=document.querySelector("#errors-context"),y=h.timeline({paused:!0,defaults:{ease:$.easeInOut,duration:.5}});y.from(l,{opacity:0,translateY:25,transformOrigin:"bottom"});const j=()=>{l.classList.replace("hidden","fixed"),y.play(),E.classList.add("overflow-hidden"),u.src="assets/icons/close.svg"},S=()=>{y.reverse(),setTimeout(()=>{l.classList.replace("fixed","hidden")},500),u.src="assets/icons/menu.svg",E.classList.remove("overflow-hidden")},B=()=>{const n=b.children;for(let e=0;e<n.length;e++){const c=n.item(e).getBoundingClientRect();if(c.top&&c.left&&c.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&c.right<=(window.innerWidth||document.documentElement.clientWidth)){const t=P.children.item(1),s=e-1<1||e-1===2?e:e-1,d=t.children.item(s);for(let m=0;m<t.children.length;m++){const v=t.children.item(m);v.style.opacity="0.6",v.style.zIndex="unset"}if(d===null)return;d.style.opacity="1",d.style.zIndex="1"}}},H=()=>{document.addEventListener("scroll",()=>{B()}),u.addEventListener("click",()=>{l.classList.contains("fixed")&&u.src.includes("close.svg")?S():j()}),l.addEventListener("click",()=>{S()})},w=n=>{h.set(i,{clipPath:"polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)",translateY:25,display:"none"}),f.innerText="";for(const o in n)f.innerText+=`${n[o]}, `;const e=h.timeline({paused:!0,defaults:{ease:T.easeOut,duration:.5}});e.set(i,{display:"block"}).to(i,{clipPath:"polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",translateY:0,transformOrigin:"bottom center"}).to(i,{clipPath:"polygon(0% 100%, 100% 100%, 100% 100%, 0% 100%)",transformOrigin:"bottom center",translateY:25,delay:5}).set(i,{display:"none"}),e.play()},R=n=>{D.value=n.toString()},L=(n,e,o,c,t,s)=>{t=t.replace(c,""),t=t.replace("\u2013",""),t=t.trim(),e!==1&&(t=`${t}s`),x.innerText=`${e} ${t}`,s=new Date(s).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}),U.innerText=`${n} ${o} = ${e} ${c}, ${s}`};function W(n,e,o,c){return fetch(n,{method:e,headers:{"content-type":"application/json;charset=UTF-8",accept:"application/json"},body:JSON.stringify({token:o,values:c}),mode:"cors",cache:"default"}).then(t=>{if(!t.ok)throw new Error(`${t.status}: ${t.statusText}`);return t.json()}).then(t=>t)}const Y=()=>{for(let n=0;n<r.length;n++){const e=r[n],o=e.options[e.selectedIndex],c=o.id.split("~"),t=Number.parseInt(c[0]);O[t].src=`https://hatscripts.github.io/circle-flags/flags/${c[1]}.svg`,e.id==="from"&&(k.innerText=o.value)}},q=async(n,e)=>{const o=`http://localhost:8080${n}`;let c=null;return await W(o,"POST",C.value,e).then(({value:t,errors:s})=>{c=t,s.length>0&&(w(s),c=null)}).catch(t=>{w([t.message]),console.error(t),c=null}),c},z=()=>{const n=new Date;L("1",1,"EUR","EUR","EUR \u2013 Euro",n.toISOString())},A=()=>{const n=new Event("input");p.dispatchEvent(n)},F=()=>{a.addEventListener("change",n=>{const e=n.target,t=new Date(e.value).toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}).split("/");e.setAttribute("data-date",`${t[1]}/${t[0]}/${t[2]}`)})},N=()=>{const n=new Event("change");[r[0],a].forEach(o=>{o.dispatchEvent(n)})},J=()=>{z(),F(),p.addEventListener("input",async e=>{e.preventDefault(),Y(),p.checkValidity()&&(x.innerText="Loading...",await q("/",{from:r[0].value,to:r[1].value,amount:g.value,date:a.value}).then(o=>{const c=r[1].options[r[1].selectedIndex].innerText;o!==null&&L(g.value,o,r[0].value,r[1].value,c,a.value)}))}),[a,r[0]].forEach(e=>{e.addEventListener("change",async()=>{await q("/rate",{date:a.value,currency:r[0].value}).then(o=>{o!==null&&R(o)})})}),I.addEventListener("click",e=>{e.preventDefault();const o=r[0].value;r[0].value=r[1].value,r[1].value=o,A(),N()})};document.addEventListener("DOMContentLoaded",()=>{H(),J()});
